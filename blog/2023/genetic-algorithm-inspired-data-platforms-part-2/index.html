<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="R3nPzqP9nO2aTgysGUiU3t-pw3wi1xuUuKVaMrimuck"> <meta name="msvalidate.01" content="04fec5e0d64b1c9bc788e98f81ee2a78"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Evolutionary Bytes - Harnessing Genetic Algorithms for Smarter Data Platforms (Part 2/2) | Subhadip Mitra </title> <meta name="author" content="Subhadip Mitra"> <meta name="description" content="Explore how genetic algorithms revolutionize data platforms, offering adaptive, dynamic solutions to meet complex challenges in the fast-evolving digital landscape."> <meta name="keywords" content="subhadip-mitra,subhadip,google,google-cloud,data-&amp;-analytics,ai-innovations,enterprise-technology-leadership,digital-transformation,machine-learning-models,cloud-technologies,quantum-computing,technology-consulting,singapore,researcher,llm,genai"> <meta property="og:site_name" content="Subhadip Mitra"> <meta property="og:type" content="article"> <meta property="og:title" content="Subhadip Mitra | Evolutionary Bytes - Harnessing Genetic Algorithms for Smarter Data Platforms (Part 2/2)"> <meta property="og:url" content="https://subhadipmitra.com/blog/2023/genetic-algorithm-inspired-data-platforms-part-2/"> <meta property="og:description" content="Explore how genetic algorithms revolutionize data platforms, offering adaptive, dynamic solutions to meet complex challenges in the fast-evolving digital landscape."> <meta property="og:image" content="/assets/img/social_preview.png"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Evolutionary Bytes - Harnessing Genetic Algorithms for Smarter Data Platforms (Part 2/2)"> <meta name="twitter:description" content="Explore how genetic algorithms revolutionize data platforms, offering adaptive, dynamic solutions to meet complex challenges in the fast-evolving digital landscape."> <meta name="twitter:image" content="/assets/img/social_preview.png"> <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Subhadip Mitra"
        },
        "url": "https://subhadipmitra.com/blog/2023/genetic-algorithm-inspired-data-platforms-part-2/",
        "@type": "BlogPosting",
        "description": "Explore how genetic algorithms revolutionize data platforms, offering adaptive, dynamic solutions to meet complex challenges in the fast-evolving digital landscape.",
        "headline": "Evolutionary Bytes - Harnessing Genetic Algorithms for Smarter Data Platforms (Part 2/2)",
        
        "name": "Subhadip Mitra",
        "@context": "https://schema.org"
    }
  </script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&amp;family=Inter+Tight:ital,wght@0,100..900;1,100..900&amp;family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon.png?058310854f7b3c920f894a1d42c3c47b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://subhadipmitra.com/blog/2023/genetic-algorithm-inspired-data-platforms-part-2/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Subhadip</span> Mitra </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">more </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/archive/">archive</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/contact/">contact</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/license/">licenses</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/privacy/">privacy</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Evolutionary Bytes - Harnessing Genetic Algorithms for Smarter Data Platforms (Part 2/2)</h1> <p class="post-meta"> Created on December 29, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/data"> <i class="fa-solid fa-hashtag fa-sm"></i> data</a>   <a href="/blog/tag/platform"> <i class="fa-solid fa-hashtag fa-sm"></i> platform</a>   <a href="/blog/tag/genetic"> <i class="fa-solid fa-hashtag fa-sm"></i> genetic</a>   <a href="/blog/tag/algorithms"> <i class="fa-solid fa-hashtag fa-sm"></i> algorithms</a>   <a href="/blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> code</a>   ·   <a href="/blog/category/platform"> <i class="fa-solid fa-tag fa-sm"></i> platform</a>   <a href="/blog/category/algorithms"> <i class="fa-solid fa-tag fa-sm"></i> algorithms</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p><a href="/blog/2023/genetic-algorithm-inspired-data-platforms-part-1/">In part 1 of this series</a>, we explored the power of genetic algorithms in shaping data platforms and powering e-commerce personalization. Now, we’ll take a more platform-specific technical turn. Let’s uncover how genetic algorithms revolutionize database query optimization, leading to lightning-fast responses and efficient resource usage.</p> <p><br></p> <h2 id="understanding-query-execution-plans">Understanding Query Execution Plans</h2> <ul> <li> <strong>Query</strong>: A database query is a request for specific data from the database tables. Queries often involve multiple tables, joins to connect those tables, and filters/sorts to refine the result set.</li> <li> <strong>Execution Plan</strong>: The database engine doesn’t just execute the query as written. First, it analyzes the query and generates a variety of potential “execution plans.” Each execution plan is a step-by-step set of operations to retrieve the requested data. Examples of the choices it would make: <ul> <li>Join order (which tables to combine first)</li> <li>Join methods (e.g., nested loop join, hash join, merge join)</li> <li>Whether or not to utilize indexes</li> </ul> </li> <li> <strong>Cost Estimation</strong>: The database engine can estimate the cost (in terms of time or resource consumption) of each possible plan. Choosing the optimal query execution plan is critical for performance, especially with complex queries.</li> </ul> <p><br></p> <h2 id="the-challenge-of-optimization">The Challenge of Optimization</h2> <p>The number of possible execution plans grows exponentially as the complexity of a query increases. With many tables and joins, it becomes impossible for the database engine to exhaustively evaluate every plan to find the truly optimal one. Traditional optimizers often rely on heuristics that might lead to good, but not perfect, plans.</p> <p><br></p> <h2 id="where-genetic-algorithms-come-in">Where Genetic Algorithms Come In</h2> <p>Genetic algorithms (GAs) mimic evolutionary principles to find near-optimal solutions within huge search spaces. Here’s how they apply to query optimization:</p> <ul> <li> <p><strong>Representation (Chromosomes)</strong>: Each possible execution plan is encoded as a ‘chromosome’. This could be a tree-like structure representing the order of joins and operations, an array representing index selection, etc.</p> </li> <li> <p><strong>Initial Population</strong>: The GA starts with a population of randomly generated chromosomes (execution plans).</p> </li> <li> <p><strong>Fitness Function</strong>: The key is defining a way to score the ‘fitness’ of a plan. Typically, this uses the database engine’s cost estimation to calculate the estimated execution time or resource usage.</p> </li> <li> <p><strong>Selection</strong>: Fitter chromosomes (those with lower estimated costs) have a higher probability of being selected for ‘reproduction’.</p> </li> <li> <p><strong>Crossover</strong>: Selected chromosomes are combined. For example, parts of the tree structures representing two plans might be swapped to create new plans. This combines potentially good aspects of multiple candidate solutions</p> </li> <li> <p><strong>Mutation</strong>: Random changes are introduced into some chromosomes. This helps avoid getting stuck in a local optimum and promotes exploration of the search space.</p> </li> <li> <p><strong>Iterative Evolution</strong>: The steps of selection, crossover, and mutation are repeated over multiple generations. The average fitness of the population should improve over time.</p> </li> </ul> <p><br></p> <h2 id="foundation-query-optimizer-class">Foundation Query Optimizer class</h2> <p>Below is an initial class repr of the query optimizer funtion. It assumes a Postgres implementation, and 3 table joins, e.g. Customer, Products, Transactions. More complex representations can be taken up, to accurately reflect real-world formultations. But, for now, lets proceed with a simplified approach.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">random</span>

<span class="k">class</span> <span class="nc">PostgresQueryOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">population_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">,</span> <span class="n">crossover_rate</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">population_size</span> <span class="o">=</span> <span class="n">population_size</span>
        <span class="n">self</span><span class="p">.</span><span class="n">mutation_rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
        <span class="n">self</span><span class="p">.</span><span class="n">crossover_rate</span> <span class="o">=</span> <span class="n">crossover_rate</span>

    <span class="k">def</span> <span class="nf">chromosome_representation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Defines how execution plans are encoded for Postgres</span><span class="sh">"""</span>
        <span class="c1">#  Join order represented as (table1, table2) tuples
</span>        <span class="c1">#  Join methods as 'NL' (nested loop), 'HJ' (hash join), 'MJ' (merge join)
</span>        <span class="n">chromosome</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Randomly select two tables to join first
</span>        <span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">customer</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">product</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">transaction</span><span class="sh">"</span><span class="p">]</span>
        <span class="n">table1</span><span class="p">,</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="n">tables</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">))</span>

        <span class="c1"># Randomly select join method for the first join
</span>        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">"</span><span class="s">NL</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">HJ</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MJ</span><span class="sh">"</span><span class="p">]))</span>

        <span class="c1"># Select the remaining table and its join method
</span>        <span class="n">remaining_table</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span> <span class="k">if</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">remaining_table</span><span class="p">,</span> <span class="n">chromosome</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># Maintain previous join order for the 3rd table
</span>        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">"</span><span class="s">NL</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">HJ</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MJ</span><span class="sh">"</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">chromosome</span>

    <span class="k">def</span> <span class="nf">generate_initial_population</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Creates the starting set of chromosomes</span><span class="sh">"""</span>
        <span class="n">population</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">population_size</span><span class="p">):</span>
            <span class="n">population</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">chromosome_representation</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">population</span>

    <span class="k">def</span> <span class="nf">fitness_function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">chromosome</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Estimates execution cost using EXPLAIN ANALYZE</span><span class="sh">"""</span>
        <span class="c1"># Replace with actual Postgres EXPLAIN ANALYZE execution
</span>        <span class="n">explain_output</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">EXPLAIN ANALYZE SELECT * FROM customer JOIN </span><span class="si">{</span><span class="n">chromosome</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> ON </span><span class="si">{</span><span class="o">/*</span> <span class="n">join</span> <span class="n">condition</span> <span class="o">*/</span><span class="si">}</span><span class="s"> JOIN </span><span class="si">{</span><span class="n">chromosome</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> ON </span><span class="si">{</span><span class="o">/*</span> <span class="n">join</span> <span class="n">condition</span> <span class="o">*/</span><span class="si">}</span><span class="sh">"</span>
        <span class="c1"># Placeholder - Parse EXPLAIN output to estimate cost (Postgres-specific)
</span>        <span class="c1"># This is a simplified version, a real implementation would involve parsing the EXPLAIN output for metrics like execution time
</span>        <span class="k">return</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Replace with cost estimation logic
</span>
    <span class="k">def</span> <span class="nf">selection</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Probabilistic selection based on fitness (Tournament Selection)</span><span class="sh">"""</span>
        <span class="c1"># Select a small subset of chromosomes for competition
</span>        <span class="n">tournament_size</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">tournament</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">tournament_size</span><span class="p">)</span>

        <span class="c1"># Return the one with the best fitness among
</span>        <span class="n">best_in_tournament</span> <span class="o">=</span> <span class="n">tournament</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">tournament</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">fitness_function</span><span class="p">(</span><span class="n">individual</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="nf">fitness_function</span><span class="p">(</span><span class="n">best_in_tournament</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
                <span class="n">best_in_tournament</span> <span class="o">=</span> <span class="n">individual</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">best_in_tournament</span><span class="p">,</span> <span class="n">best_in_tournament</span><span class="p">]</span>  <span class="c1"># Two parents from the same tournament
</span>
    <span class="k">def</span> <span class="nf">crossover</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">chromosome1</span><span class="p">,</span> <span class="n">chromosome2</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Combines chromosomes while maintaining valid join order</span><span class="sh">"""</span>
        <span class="n">crossover_point</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Crossover between 1st or 2nd join
</span>        <span class="n">new_chromosome</span> <span class="o">=</span> <span class="n">chromosome1</span><span class="p">[:</span><span class="n">crossover_point</span><span class="p">]</span> <span class="o">+</span> <span class="n">chromosome2</span><span class="p">[</span><span class="n">crossover_point</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">new_chromosome</span>

    <span class="k">def</span> <span class="nf">mutation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">chromosome</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Introduces small changes with a probability</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">mutation_rate</span><span class="p">:</span>
            <span class="n">mutation_point</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mutation_point</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Mutate join order
</span>                <span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">customer</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">product</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">transaction</span><span class="sh">"</span><span class="p">]</span>
                <span class="n">table1</span><span class="p">,</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="n">tables</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">chromosome</span><span class="p">[</span><span class="n">mutation_point</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Mutate join method
</span>                <span class="n">chromosome</span><span class="p">[</span><span class="n">mutation_point</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">"</span><span class="s">NL</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">HJ</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MJ</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">chromosome</span>

    <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">max_generations</span><span class="p">):</span>
        <span class="n">population</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">generate_initial_population</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">max_generations</span><span class="p">):</span>
            <span class="n">fitness_scores</span> <span class="o">=</span> <span class="p">[(</span><span class="n">self</span><span class="p">.</span><span class="nf">fitness_function</span><span class="p">(</span><span class="n">chromosome</span><span class="p">,</span> <span class="n">query</span><span class="p">),</span> <span class="n">chromosome</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">chromosome</span> <span class="ow">in</span> <span class="n">population</span><span class="p">]</span>
            <span class="n">fitness_scores</span><span class="p">.</span><span class="nf">sort</span><span class="p">()</span>  <span class="c1"># Assuming lower cost is better
</span>
            <span class="n">new_population</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">new_population</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">population_size</span><span class="p">:</span>
                <span class="n">parents</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">selection</span><span class="p">(</span><span class="n">fitness_scores</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">crossover_rate</span><span class="p">:</span>
                    <span class="n">children</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">crossover</span><span class="p">(</span><span class="o">*</span><span class="n">parents</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">children</span> <span class="o">=</span> <span class="n">parents</span>

                <span class="n">new_population</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">mutation</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">)</span>

            <span class="n">population</span> <span class="o">=</span> <span class="n">new_population</span>

        <span class="n">best_chromosome</span><span class="p">,</span> <span class="n">best_cost</span> <span class="o">=</span> <span class="n">fitness_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">best_chromosome</span>

</code></pre></div></div> <p><br></p> <p><strong>Initialization</strong>:</p> <p><code class="language-plaintext highlighter-rouge">__init__(self, population_size, mutation_rate, crossover_rate)</code>: This function sets up the optimizer with hyperparameters like population size (number of candidate plans to consider simultaneously), mutation rate (how often chromosomes change slightly), and crossover rate (how often chromosomes exchange information).</p> <p><strong>Chromosome Representation</strong> (<code class="language-plaintext highlighter-rouge">chromosome_representation</code>):</p> <ul> <li>This function defines how possible execution plans (chromosomes) are encoded.</li> <li>In this case, a chromosome is a list containing information about joins: <ul> <li>The first two elements are tuples representing the join order (table1, table2).</li> <li>The following elements specify the join method (‘NL’ for nested loop, ‘HJ’ for hash join, ‘MJ’ for merge join) used for each join.</li> </ul> </li> <li>The function randomly selects two tables for the initial join, then a join method, and repeats this process to determine how the remaining table is joined.</li> </ul> <p><strong>Initial Population</strong> (<code class="language-plaintext highlighter-rouge">generate_initial_population</code>):</p> <p>This function creates a starting set of chromosomes (candidate execution plans) by calling chromosome_representation multiple times (based on the population size).</p> <p><strong>Fitness Function</strong> (<code class="language-plaintext highlighter-rouge">fitness_function</code>):</p> <ul> <li>This function aims to estimate the execution cost (time or resource usage) associated with a particular chromosome (plan).</li> <li>In a real scenario, it would use Postgres’s EXPLAIN ANALYZE functionality to execute the plan and analyze the cost metrics from the output.</li> <li>Here, a simplified approach uses a placeholder with a random cost value.</li> </ul> <p><strong>Selection</strong> (<code class="language-plaintext highlighter-rouge">selection</code>):</p> <ul> <li>This function selects “parent” chromosomes that will be used to create the next generation in the genetic algorithm.</li> <li>It implements a Tournament Selection strategy. Here’s the process: <ul> <li>A small subset of chromosomes is randomly chosen (tournament size). -The chromosome within the tournament with the lowest estimated cost (the “fittest”) is selected as a parent (twice, to ensure two parents for crossover).</li> </ul> </li> </ul> <p><strong>Crossover</strong> (<code class="language-plaintext highlighter-rouge">crossover</code>):</p> <ul> <li>This function combines genetic material from two parent chromosomes to create offspring (new candidate plans).</li> <li>It selects a random point between the specifications for the first two joins and swaps the remaining information (join order and method) between the parents to create a new child chromosome.</li> </ul> <p><strong>Mutation</strong> (<code class="language-plaintext highlighter-rouge">mutation</code>):</p> <ul> <li>This function introduces random changes to chromosomes with a small probability (mutation rate).</li> <li>Here, it can either: <ul> <li>Mutate the join order by randomly selecting a new pair of tables to join first.</li> <li>Mutate the join method used in one of the joins (switching between ‘NL’, ‘HJ’, and ‘MJ’).</li> </ul> </li> </ul> <p><strong>Optimization</strong> (<code class="language-plaintext highlighter-rouge">optimize</code>):</p> <ul> <li>This is the core function that drives the entire optimization process. Here’s what it does:</li> <li>Starts with an initial population of chromosomes.</li> <li>Iterates for a specified number of generations (cycles of selection, crossover, and mutation).</li> <li>In each generation: <ul> <li>Estimates the fitness (cost) of each chromosome in the population.</li> <li>Uses Tournament Selection to choose parents.</li> <li>Applies crossover or mutation to create new offspring (candidate plans).</li> <li>Creates a new population for the next generation.</li> </ul> </li> <li>After iterating, the function returns the chromosome with the lowest estimated cost (considered the “best” execution plan).</li> </ul> <p><br></p> <p>While the above is a good starting point for a theoretical treatise, a real world implementation would involve more sophistacted cost estimation logic that leverages Postgres’ <code class="language-plaintext highlighter-rouge">EXPLAIN ANALYZE</code> output for detailed metrics.</p> <p><br></p> <iframe width="100%" height="400" src="https://www.youtube.com/embed/Kdjz2e8HYPU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""> </iframe> <p><br></p> <p><code class="language-plaintext highlighter-rouge">chromosome_representation</code> function in the <code class="language-plaintext highlighter-rouge">PostgresQueryOptimizer</code> class can be modified to incorporate indexes and sort orders into our execution plan optimization. The above array-based representation is modified below to include additional elements for index and sort considerations:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">chromosome_representation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="c1"># ... (Existing join order and join methods logic) ...
</span>
    <span class="c1"># Index Selection (One decision per table)
</span>    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">customer</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">product</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">transaction</span><span class="sh">"</span><span class="p">]:</span>
        <span class="c1"># Assume you have a way to determine relevant indexes for the table
</span>        <span class="n">available_indexes</span> <span class="o">=</span> <span class="nf">get_available_indexes</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">available_indexes</span> <span class="o">+</span> <span class="p">[</span><span class="sh">"</span><span class="s">NO_INDEX</span><span class="sh">"</span><span class="p">]))</span>

    <span class="c1"># Sort Orders (One decision per join, if applicable)
</span>    <span class="k">for</span> <span class="n">join_index</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># Only if multiple joins
</span>        <span class="c1"># Assume you know on which columns of a table sorting is relevant
</span>        <span class="n">relevant_columns</span> <span class="o">=</span> <span class="nf">get_relevant_sort_columns</span><span class="p">(</span><span class="n">chromosome</span><span class="p">[</span><span class="n">join_index</span><span class="p">])</span>
        <span class="n">chromosome</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">relevant_columns</span> <span class="o">+</span> <span class="p">[</span><span class="sh">"</span><span class="s">NO_SORT</span><span class="sh">"</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">chromosome</span>

</code></pre></div></div> <p><strong>Updates</strong></p> <ul> <li> <p><strong>Index Selection</strong>: For each table, we randomly select from available indexes using a function called <code class="language-plaintext highlighter-rouge">get_available_indexes</code> (we’d need to implement this based on how we retrieve index information from Postgres). We include <code class="language-plaintext highlighter-rouge">"NO_INDEX"</code> as an option.</p> </li> <li> <p><strong>Sort Orders</strong>: For each join (if applicable), we determine relevant columns for sorting with a function <code class="language-plaintext highlighter-rouge">get_relevant_sort_columns</code> (implementation also required). A <code class="language-plaintext highlighter-rouge">"NO_SORT"</code> option signifies no explicit sorting on the join result.</p> </li> </ul> <p><br></p> <p><strong>Example Chromosome</strong> <code class="language-plaintext highlighter-rouge">[('customer', 'product'), 'HJ', ('transaction', 'customer'), 'NL', 'idx_customer_name', 'NO_INDEX', 'idx_product_id', 'customer_id', 'NO_SORT']</code></p> <p><br></p> <p><strong>Additional considerations</strong></p> <ul> <li> <p><strong>Helper Functions</strong>: we would need to also implement</p> <ul> <li> <code class="language-plaintext highlighter-rouge">get_available_indexes(table)</code>: A function to fetch the list of available indexes for a given table in Postgres.</li> <li> <code class="language-plaintext highlighter-rouge">get_relevant_sort_columns(join_tuple)</code>. This function would determine which columns are relevant for sorting based on the joined tables and the query conditions.</li> </ul> </li> <li> <strong>Conditional Logic</strong>: We would need to introduce logic to only include index or sorting decisions when they’re actually relevant to the query.</li> <li> <strong>Chromosome Validity</strong>: We should also consider adding checks to ensure the combination of represented elements (join order, table, index, sort column) is always a valid option with respect to the query and database schema.</li> </ul> <p><br></p> <h2 id="conclusion">Conclusion</h2> <p>We’ve journeyed from the inspiration behind genetic algorithms to their transformative power in database query optimization. This two-part series highlights the potential for not just personalization, but also for accelerating your analytics and decision-making through streamlined database performance. The future of data platforms promises to be one where intelligent algorithms work hand-in-hand with traditional database structures.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/implementing-model-context-protocol/">Implementing Model Context Protocol in Autonomous Multi-Agent Systems - Technical Architecture and Performance Optimization</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/telecom-autonomous-multi-agent-genai-system/">Engineering Autonomous Multi-Agent Systems - A Technical Deep Dive into Telecom Customer Service</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/retail-bank-multi-agent-system/">Engineering Multi-Agent Systems - A Retail Banking Case Study</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/etlc-adaptive-contexts-and-contextual-joins/">ETLC 2.0 - Building Context-Aware Data Pipelines</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/end-of-data-warehouses/">The End of Data Warehouses? Enter the Age of Dynamic Context Engines</a> </li> <br> <div class="newsletter-form-container newsletter-signup"> <p class="newsletter-title">Strategic Insights for Technology Leaders</p> <p>Join my newsletter for exclusive content on leveraging Data, AI, and Cloud to drive digital transformation and achieve breakthrough business results. Stay informed on the latest trends, strategies, and best practices for leading in the age of intelligent systems.</p> <p><a href="/archive/" target="_blank">Read the Blog Archive in the meantime</a></p> <form class="newsletter-form" action="https://app.loops.so/api/newsletter-form/cm614n2d604nlfy1lfo7vgmo5" method="POST" style="justify-content: center"> <input class="newsletter-form-input" name="newsletter-form-input" type="email" placeholder="user@example.com" required=""> <button type="submit" class="newsletter-form-button" style="justify-content: center"> subscribe </button> <button type="button" class="newsletter-loading-button" style="justify-content: center"> Please wait... </button> </form> <div class="newsletter-success" style="justify-content: center"> <p class="newsletter-success-message">You're going to love this! Thanks for subscribing.</p> </div> <div class="newsletter-error" style="justify-content: center"> <p class="newsletter-error-message">Oops! Something went wrong, please try again</p> </div> <button class="newsletter-back-button" type="button" onmouseout='this.style.textDecoration="none"' onmouseover='this.style.textDecoration="underline"'> ← Back </button> </div> <noscript> <style>.newsletter-form-container{display:none}</style> </noscript> <div id="giscus_thread" style="max-width: 1140px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'bassrehab/bassrehab.github.io',
        'data-repo-id': 'R_kgDOLvY8Tg',
        'data-category': 'Comments',
        'data-category-id': 'DIC_kwDOLvY8Ts4CexzE',
        'data-mapping': 'title',
        'data-strict': '0',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Subhadip Mitra. Some Rights Reserved. Last updated: May 08, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-TW7YQ5XPC6"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-TW7YQ5XPC6');
  </script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> <script defer src="/assets/js/newsletter.js?c3d0931971ee96e9df74ba70526c3130"></script> </body> </html>